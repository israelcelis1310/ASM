;	Israel Celis Campagnoli
;	twitter @israelcelis1310
;	https://ve.linkedin.com/in/israelceliscampagnoli
;	Practicas en Assembler Digitales III
;	Universidad Nacional Experimental "Antonio Jóse de Sucre"
;	Vicerectorado "Luis Caballero Mejías"
	.MODEL SMALL
	.STACK 100H
	.DATA
MENSAJE1	DB 02H DUP(09H)
		DB "1.- Horizontal.",0AH,0AH,0DH
		DB 02H DUP(09H)
		DB "2.- Vertical.",0AH,0AH,0DH
		DB 02H DUP(09H)
		DB "3.- Cuadrilatero.",0AH,0AH,0DH
		DB 02H DUP(09H)
		DB "4.- Diagonal.",0AH,0AH,0DH
		DB 02H DUP(09H)
		DB "5.- Triangulo.",0AH,0AH,0DH
		DB 02H DUP(09H)
		DB "6.- Salir$"

MENSAJE2	DB 02H DUP(09H)
		DB "Tipo:",0AH,0AH,0DH
		DB 02H DUP(09H)
		DB "P1F:",0AH,0AH,0DH
		DB 02H DUP(09H)
		DB "P1C:",0AH,0AH,0DH
		DB 02H DUP(09H)
		DB "P2F:",0AH,0AH,0DH
		DB 02H DUP(09H)
		DB "P2C:",0AH,0AH,0DH
FINMEN2		DB "$"
MENSAJE3	DB 02H DUP(09H)
		DB "P3F:",0AH,0AH,0DH
		DB 02H DUP(09H)
		DB "P3C:$" 
NUMERO	DB 04H
CANT	DB ?
BUFFER	DB 04H DUP(?)
P1F	DW ?
P1C	DW ?
P2F	DW ?
P2C	DW ?
P3F	DW ?
P3C	DW ?
SW	DW ?
FCORD1 		DW 0000H
CCORD1 		DW 0000H
FCORD2		DW 0000H
CCORD2		DW 0000H
ATRIBUTO        DB 03H
PENDIENTE	DW ?
DIVISOR		DW ?
RESTO		DW ?
CUENTA		DW ?
	.CODE
	MOV AX,SEG NUMERO
	MOV DS,AX
	MOV AL,03H
	CALL MODO
	MOV DX,0000H
	MOV BH,00H
	CALL CURSOR
	MOV BH,00H
	CALL BLAN
	MOV DX,0600H
	MOV BH,00H
	CALL CURSOR
	MOV DX,OFFSET MENSAJE1
	CALL IMPRIME
	MOV DX,2020H
	MOV BH,00H
	CALL CURSOR
L0:	CALL TECLA
	CMP AL,31H
	JE T1
	CMP AL,32H
	JE T2
	CMP AL,33H
	JE T3
	CMP AL,34H
	JE T4
	CMP AL,35H
	JE T5
	CMP AL,36H
	JE FIN1	
FIN1:	MOV AX,4C00H
	INT 21H
T1:	MOV AL,01H
	CALL PAG
	CALL MENU2
	MOV DX,0616H
	CALL CURSOR
	MOV AL,"H"
	CALL ESCRIB	 
	JMP PUNTOS	
T2:	MOV AL,01H
	CALL PAG
	CALL MENU2
	MOV DX,0616H
	CALL CURSOR
	MOV AL,"V"
	CALL ESCRIB	 
	JMP PUNTOS
T3:	MOV AL,01H
	CALL PAG
	CALL MENU2
	MOV DX,0616H
	CALL CURSOR
	MOV AL,"C"
	CALL ESCRIB	 
	JMP PUNTOS
T4:	MOV AL,01H
	CALL PAG
	CALL MENU2
	MOV DX,0616H
	CALL CURSOR
	MOV AL,"D"
	CALL ESCRIB	 
	JMP PUNTOS
T5:	MOV AL,01H
	CALL PAG
	MOV FINMEN2,20H
	CALL MENU2
	MOV DX,0616H
	CALL CURSOR
	MOV AL,"T"
	CALL ESCRIB	 
	JMP PUNTOS2
PUNTOS:	MOV DX,0816H
	CALL CURSOR
	MOV DX,OFFSET NUMERO
	CALL EDIT
	CALL GN
	MOV P1F,AX
	MOV DX,0A16H
	CALL CURSOR
	MOV DX,OFFSET NUMERO
	CALL EDIT
	CALL GN
	MOV P1C,AX
	MOV DX,0C16H
	CALL CURSOR
	MOV DX,OFFSET NUMERO
	CALL EDIT
	CALL GN
	MOV P2F,AX
	MOV DX,0E16H
	CALL CURSOR
	MOV DX,OFFSET NUMERO
	CALL EDIT
	CALL GN
	MOV P2C,AX
	JMP DIBUJA

PUNTOS2:MOV DX,0816H
	CALL CURSOR
	MOV DX,OFFSET NUMERO
	CALL EDIT
	CALL GN
	MOV P1F,AX
	MOV DX,0A16H
	CALL CURSOR
	MOV DX,OFFSET NUMERO
	CALL EDIT
	CALL GN
	MOV P1C,AX
	MOV DX,0C16H
	CALL CURSOR
	MOV DX,OFFSET NUMERO
	CALL EDIT
	CALL GN
	MOV P2F,AX
	MOV DX,0E16H
	CALL CURSOR
	MOV DX,OFFSET NUMERO
	CALL EDIT
	CALL GN
	MOV P2C,AX
	MOV DX,1016H
	CALL CURSOR
	MOV DX,OFFSET NUMERO
	CALL EDIT
	CALL GN
	MOV P3F,AX
	MOV DX,1216H
	CALL CURSOR
	MOV DX,OFFSET NUMERO
	CALL EDIT
	CALL GN
	MOV P3C,AX
	JMP DIBUJA

DIBUJA:	MOV AL,0FH
	CALL MODO
	MOV AX,P1F
	MOV BX,P2F
	CMP AX,BX
	JNE PASO2
	MOV AX,P1C
	MOV BX,P2C
	CMP AX,BX
	JNE PASO1
	CALL PUNTO
	JMP FIN

PASO1:	JA INVIERTE
	MOV AX,P1F
	MOV FCORD1,AX
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV AX,P2C
	MOV CCORD2,AX
	CALL HORIZONTAL
	JMP FIN
INVIERTE: MOV AX,P1F
	MOV FCORD1,AX
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD2,AX
	MOV AX,P2C
	MOV CCORD1,AX
	CALL HORIZONTAL
	JMP FIN

PASO2:	MOV AX,P1C
	MOV BX,P2C
	CMP AX,BX
	JNE PASO3
	MOV AX,P1F
	MOV BX,P2F
	CMP AX,BX	
	JA INVIERTE1
	MOV AX,P1F
	MOV FCORD1,AX
	MOV AX,P2F
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV CCORD2,AX
	CALL VERTICAL
	JMP FIN
INVIERTE1: MOV BX,P2C
	MOV CCORD1,BX
	MOV CCORD2,BX
	MOV AX,P1F
	MOV FCORD2,AX
	MOV AX,P2F
	MOV FCORD1,AX
	CALL VERTICAL
	JMP FIN

PASO3:	MOV AX,P1F
	MOV BX,P2F
	CMP AX,BX
	JA CASO2
	MOV AX,P1C
	MOV BX,P2C
	CMP AX,BX
	JNB CASO3
CASO1:	MOV AX,P1F
	MOV FCORD1,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV AX,P2F
	MOV FCORD2,AX
	MOV AX,P2C
	MOV CCORD2,AX
	CALL PENDIENTE_N
	JMP FIN

CASO2:	MOV AX,P1C
	MOV BX,P2C
	CMP AX,BX
	JNA CASO4
	MOV AX,P2F
	MOV FCORD1,AX
	MOV AX,P2C
	MOV CCORD1,AX
	MOV AX,P1F
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD2,AX
	CALL PENDIENTE_N
	JMP FIN

CASO3: 	MOV AX,P1F
	MOV FCORD1,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV AX,P2F
	MOV FCORD2,AX
	MOV AX,P2C
	MOV CCORD2,AX
	CALL PENDIENTE_P
	JMP FIN

CASO4: 	MOV AX,P2F
	MOV FCORD1,AX
	MOV AX,P2C
	MOV CCORD1,AX
	MOV AX,P1F
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD2,AX
	CALL PENDIENTE_P
	JMP FIN

;AREA DE RUTINAS PARA DIBUJAR FIGURAS

PUNTO:	MOV AH,0CH
	MOV BH,00H
	MOV AL,ATRIBUTO
	MOV DX,P1F
	MOV CX,P1C
	INT 10H
	RET

HORIZONTAL:	MOV BP,CCORD2
		SUB BP,CCORD1
		INC BP
		MOV CX,CCORD1
LAZO1:		MOV AH,0CH
		MOV BH,00H
		MOV AL,ATRIBUTO
		MOV DX,FCORD1
		INT 10H
		INC CX
		DEC BP
		JNZ LAZO1
		RET

VERTICAL:       MOV BP,FCORD2	
		SUB BP,FCORD1
		INC BP
		MOV CX,FCORD1
LAZO2:		MOV AH,0CH
		MOV BH,00H
		MOV AL,ATRIBUTO
		MOV DX,CCORD1
		INT 10H
		INC DX
		DEC BP
		JNZ LAZO2
		RET

PENDIENTE_N:	MOV AX,CCORD2
		SUB AX,CCORD1
		MOV BX,FCORD2
		SUB BX,FCORD1
		CMP AX,BX
		JNAE INVIERTE2
		MOV BP,0000H
		MOV DIVISOR,BX
		MOV DX,0000H
		DIV BX
		MOV RESTO,DX
		MOV CUENTA,0000H
		MOV PENDIENTE,AX
		MOV DX,FCORD1
		MOV CX,CCORD1
LAZO30:		MOV DI,PENDIENTE
		ADD DI,BP
		MOV BP,0000H
LAZO31:		MOV AH,0CH
		MOV BH,00H
		MOV AL,ATRIBUTO
		INT 10H
		INC CX
		DEC DI
		JNZ LAZO31
		INC DX
		CMP DX,FCORD2
		JAE SIGU1
		MOV AX,RESTO
		ADD AX,CUENTA
		MOV CUENTA,AX
		CMP AX,DIVISOR
		JNAE SIGUE1
		INC BP
		MOV AX,CUENTA
		SUB AX,DIVISOR
		MOV CUENTA,AX
SIGUE1:		CMP DX,FCORD2
		JNAE LAZO30
SIGU1:		RET

INVIERTE2:   	XCHG AX,BX
		MOV BP,0000H
		MOV DIVISOR,BX
		MOV DX,0000H
		DIV BX
		MOV RESTO,DX
		MOV CUENTA,0000H
		MOV PENDIENTE,AX
		MOV DX,FCORD1
		MOV CX,CCORD1
LAZO32:		MOV DI,PENDIENTE
		ADD DI,BP
		MOV BP,0000H
LAZO33:		MOV AH,0CH
		MOV BH,00H
		MOV AL,ATRIBUTO
		INT 10H
		INC DX
		CMP DX,FCORD2
		JAE SIGU2
		DEC DI
		JNZ LAZO33
		INC CX
		MOV AX,RESTO
		ADD AX,CUENTA
		MOV CUENTA,AX
		CMP AX,DIVISOR
		JNAE SIGUE2
		INC BP
		MOV AX,CUENTA
		SUB AX,DIVISOR
		MOV CUENTA,AX
SIGUE2:		CMP DX,FCORD2
		JNAE LAZO32
SIGU2:		RET

PENDIENTE_P:	MOV AX,CCORD1
		SUB AX,CCORD2
		MOV BX,FCORD2
		SUB BX,FCORD1
		CMP AX,BX
		JNAE INVIERTE3
		MOV BP,0000H
		MOV DIVISOR,BX
		MOV DX,0000H
		DIV BX
		MOV RESTO,DX
		MOV CUENTA,0000H
		MOV PENDIENTE,AX
		MOV DX,FCORD1
		MOV CX,CCORD1
LAZO40:		MOV DI,PENDIENTE
		ADD DI,BP
		MOV BP,0000H
LAZO41:		MOV AH,0CH
		MOV BH,00H
		MOV AL,ATRIBUTO
		INT 10H
		DEC CX
		DEC DI
		JNZ LAZO41
		INC DX
		CMP DX,FCORD2
		JAE SIGU4
		MOV AX,RESTO
		ADD AX,CUENTA
		MOV CUENTA,AX
		CMP AX,DIVISOR
		JNAE SIGUE4
		INC BP
		MOV AX,CUENTA
		SUB AX,DIVISOR
		MOV CUENTA,AX
SIGUE4:		CMP DX,FCORD2
		JNAE LAZO40
SIGU4:		RET

INVIERTE3:   	XCHG AX,BX
		MOV BP,0000H
		MOV DIVISOR,BX
		MOV DX,0000H
		DIV BX
		MOV RESTO,DX
		MOV CUENTA,0000H
		MOV PENDIENTE,AX
		MOV DX,FCORD1
		MOV CX,CCORD1
LAZO42:		MOV DI,PENDIENTE
		ADD DI,BP
		MOV BP,0000H
LAZO43:		MOV AH,0CH
		MOV BH,00H
		MOV AL,ATRIBUTO
		INT 10H
		INC DX
		CMP DX,FCORD2
		JAE FIN2
		DEC DI
		JNZ LAZO43
		INC CX
		MOV AX,RESTO
		ADD AX,CUENTA
		MOV CUENTA,AX
		CMP AX,DIVISOR
		JNAE SIGUE3
		INC BP
		MOV AX,CUENTA
		SUB AX,DIVISOR
		MOV CUENTA,AX
SIGUE3:		CMP DX,FCORD2
		JNAE LAZO42
FIN2:  		CALL TECLA
       		MOV AX,4C00H
		INT 21H

;RUTINAS

MODO:	MOV AH,00H
	INT 10H
	RETN

CURSOR:	MOV AH,02H
	INT 10H
	RETN

BLAN:	MOV AH,09H
	MOV CX,2000
	MOV AL,20H
	MOV BL,07H
	INT 10H
	RETN

ESCRIB:	MOV AH,09H
	MOV BH,01H
	MOV BL,07H
	MOV CX,01H
	INT 10H
	RETN

PAG:	MOV AH,05H
	INT 10H
	RETN

EDIT:	MOV AH,0AH
	INT 21H
	RETN

IMPRIME: MOV AH,09H
	INT 21H
	RETN

TECLA:	MOV AH,00H
	INT 16H
	RETN

MENU2:	MOV DX,0000H
	MOV BH,01H
	CALL CURSOR
	MOV BH,01H
	CALL BLAN
	MOV DX,0600H
	MOV BH,01H
	CALL CURSOR
	MOV DX,OFFSET MENSAJE2
	CALL IMPRIME
	RETN

GN:	MOV SI,OFFSET BUFFER
G1:	MOV AL,DS:[SI]
 	CMP AL,30H
  	JB MALO
	CMP AL,39H
	JBE BUENO
	CMP AL,41H
	JB MALO
	CMP AL,46H
	JA MALO
	SUB AL,37H
	JMP SALIDA
MALO:	RETN
BUENO:	SUB AL,30H
SALIDA:	MOV DS:[SI],AL
	INC SI
	DEC CANT
	JNZ G1
	MOV SI,OFFSET BUFFER
	MOV AH,DS:[SI]
	INC SI
	MOV AL,DS:[SI]
	ROL AL,4
	INC SI
	OR AL,DS:[SI]
	RETN

FIN:	CALL TECLA
	MOV AX,4C00H
	INT 21H
	END
