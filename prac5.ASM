;	Israel Celis Campagnoli
;	twitter @israelcelis1310
;	https://ve.linkedin.com/in/israelceliscampagnoli
;	Practicas en Assembler Digitales III
;	Universidad Nacional Experimental "Antonio Jóse de Sucre"
;	Vicerectorado "Luis Caballero Mejías"

	.MODEL SMALL
	.STACK 100H
	.DATA
COORD	DB "Coord.dat",00H
FHCO	DW ?

BUF1	DB 1 DUP(?)
BUF2	DB 3 DUP(?)
BUF3	DB 3 DUP(?)
BUF4	DB 3 DUP(?)
BUF5	DB 5 DUP(?)
BUF6	DB 3 DUP(?)
BUF7	DB 3 DUP(?)
BUF8	DB 3 DUP(?)
BUF9	DB 3 DUP(?)
BUF10	DB 3 DUP(?)
BUF11	DB 5 DUP(?)

CANT	DB ?
BUFFER1	DB 02H DUP(?)

MSJ	DB 02H DUP(08H)
	DB "1.- DIBUJAR FIGURAS",0AH,0AH,0DH
	DB 02H DUP(08H)
	DB "2.- SALIR$"

P1F	DW ?
P1C	DW ?
P2F	DW ?
P2C	DW ?
P3F	DW ?
P3C	DW ?
P1F1	DW ?
P1C1	DW ?
COL	DW ?
FIL	DW ?
COL1	DW ?
FIL1	DW ?
SW	DW ?
FCORD1 		DW 0000H
CCORD1 		DW 0000H
FCORD2		DW 0000H
CCORD2		DW 0000H
ATRIBUTO        DB 03H
PENDIENTE	DW ?
DIVISOR		DW ?
RESTO		DW ?
CUENTA		DW ?
	.CODE
	MOV AX,SEG COORD
	MOV DS,AX

PRINC:	MOV DX,OFFSET COORD
	CALL ABRIR
	MOV FHCO,AX
	
	MOV AL,03H
	CALL MODO
	
	MOV DX,0000H
	MOV BH,00H
	CALL CURSOR
	MOV BH,00H
	CALL BLAN
	MOV DX,0600H
	MOV BH,00H
	CALL CURSOR
	
	MOV DX,OFFSET MSJ
	CALL IMPRIME
	MOV DX,2020H
	MOV BH,00H
	CALL CURSOR
	CALL TECLA
	CMP AL,31H
	JE INIC1
	CMP AL,32H
	JE FIN1
FIN1:	MOV AX,4C00H
	INT 21H

INIC1:	MOV AL,0FH
	CALL MODO

INICIO:	MOV P1F,0000H
	MOV P1C,0000H
	MOV P2F,0000H
	MOV P2C,0000H
	MOV P3F,0000H
	MOV P3C,0000H
	
	MOV AH,3FH
	MOV BX,FHCO
	MOV DX,OFFSET BUF1
	MOV CX,1
	INT 21H
	CMP CX,AX
	JNE FINAR
	CMP BUF1,"H"
	JNE L2
	JMP L1
L2:	CMP BUF1,"V"
	JNE L3
	JMP L1	
L3:	CMP BUF1,"D"
	JNE L4
	JMP L1
L4:	CMP BUF1,"C"
	JNE L5
	JMP L6
L5:	CMP BUF1,"T"
	JNE INICIO
	JMP L7

FINAR:	MOV AH,3EH
	MOV BX,FHCO
	INT 21H
	JMP PRINC

L1:	MOV AH,3FH
	MOV BX,FHCO
	MOV DX,OFFSET BUF2
	MOV CX,14
	INT 21H
	CMP CX,AX
	JE PR1
	JMP FINAR

PR1:	MOV SI,OFFSET BUF2
	CALL CONV
	MOV P1F,AX
	MOV SI,OFFSET BUF3
	CALL CONV
	MOV P1C,AX
	MOV SI,OFFSET BUF4
	CALL CONV
	MOV P2F,AX
	MOV SI,OFFSET BUF5
	CALL CONV
	MOV P2C,AX
	JMP DIBUJA

L6:	MOV AH,3FH
	MOV BX,FHCO
	MOV DX,OFFSET BUF2
	MOV CX,14
	INT 21H
	CMP CX,AX
	JE PR2
	JMP FINAR

PR2:	MOV SI,OFFSET BUF2
	CALL CONV
	MOV P1F,AX
	MOV SI,OFFSET BUF3
	CALL CONV
	MOV P1C,AX
	MOV SI,OFFSET BUF4
	CALL CONV
	MOV P2F,AX
	MOV SI,OFFSET BUF5
	CALL CONV
	MOV P2C,AX
	JMP CUAD

L7:	MOV AH,3FH
	MOV BX,FHCO
	MOV DX,OFFSET BUF6
	MOV CX,20
	INT 21H
	CMP CX,AX
	JE PR3
	JMP FINAR

PR3:	MOV SI,OFFSET BUF6
	CALL CONV
	MOV P1F,AX
	MOV SI,OFFSET BUF7
	CALL CONV
	MOV P1C,AX
	MOV SI,OFFSET BUF8
	CALL CONV
	MOV P2F,AX
	MOV SI,OFFSET BUF9
	CALL CONV
	MOV P2C,AX
	MOV SI,OFFSET BUF10
	CALL CONV
	MOV P3F,AX
	MOV SI,OFFSET BUF11
	CALL CONV
	MOV P3C,AX
	JMP TRIANG

;AREA DE RUTINAS PARA DIBUJAR FIGURAS

DIBUJA:	MOV AX,0000H
	MOV BX,0000H
	MOV CX,0000H
	MOV DX,0000H
	MOV AX,P1F
	MOV BX,P2F
	CMP AX,BX
	JNE VERT
	MOV AX,P1F
	MOV BX,P2F
	CMP AX,BX
	JA INVIERTE
	MOV AX,P1F
	MOV FCORD1,AX
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV AX,P2C
	MOV CCORD2,AX
	CALL HORIZONTAL
	CALL TECLA
	JMP INICIO
INVIERTE: MOV AX,P1F
	MOV FCORD1,AX
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD2,AX
	MOV AX,P2C
	MOV CCORD1,AX
	CALL HORIZONTAL
	CALL TECLA
	JMP INICIO

VERT:	MOV AX,0000H
	MOV BX,0000H
	MOV CX,0000H
	MOV DX,0000H
	MOV AX,P1C
	MOV BX,P2C
	CMP AX,BX
	JNE DIAG
	MOV AX,P1F
	MOV BX,P2F
	CMP AX,BX	
	JA INVIERTE1
	MOV AX,P1C
	MOV CCORD1,AX
	MOV CCORD2,BX
	MOV AX,P1F
	MOV FCORD1,AX
	MOV AX,P2F
	MOV FCORD2,BX
	CALL VERTICAL
	CALL TECLA
	JMP INICIO
INVIERTE1: MOV BX,P2C
	MOV CCORD1,BX
	MOV CCORD2,BX
	MOV AX,P1F
	MOV FCORD2,AX
	MOV AX,P2F
	MOV FCORD1,AX
	CALL VERTICAL
	CALL TECLA
	JMP INICIO

DIAG:	MOV AX,0000H
	MOV BX,0000H
	MOV CX,0000H
	MOV DX,0000H
	MOV AX,P1F
	MOV BX,P2F
	CMP AX,BX
	JA CASO2
	MOV AX,P1C
	MOV BX,P2C
	CMP AX,BX
	JNB CASO3
CASO1:	MOV AX,P1F
	MOV FCORD1,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV AX,P2F
	MOV FCORD2,AX
	MOV AX,P2C
	MOV CCORD2,AX
	CALL PENDIENTE_N
	CALL TECLA
	JMP INICIO
CASO2:	MOV AX,P1C
	MOV BX,P2C
	CMP AX,BX
	JNA CASO4
	MOV AX,P2F
	MOV FCORD1,AX
	MOV AX,P2C
	MOV CCORD1,AX
	MOV AX,P1F
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD2,AX
	CALL PENDIENTE_N
	CALL TECLA
	JMP INICIO
CASO3: 	MOV AX,P1F
	MOV FCORD1,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV AX,P2F
	MOV FCORD2,AX
	MOV AX,P2C
	MOV CCORD2,AX
	CALL PENDIENTE_P
	CALL TECLA
	JMP INICIO
CASO4: 	MOV AX,P2F
	MOV FCORD1,AX
	MOV AX,P2C
	MOV CCORD1,AX
	MOV AX,P1F
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD2,AX
	CALL PENDIENTE_P
	CALL TECLA
	JMP INICIO

CUAD:	MOV AX,0000H
	MOV BX,0000H
	MOV CX,0000H
	MOV DX,0000H
	MOV AX,P1F
	MOV FCORD1,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV AX,P2F
	MOV FCORD2,AX
	MOV AX,P2C
	MOV CCORD2,AX
	MOV AX,FCORD1
	MOV BX,FCORD2
	CMP AX,BX
	JA INVIERTE4
	MOV AX,P1C
	MOV BX,P2C
	CMP AX,BX
	JA INVIERTE5
	JMP CUAD1
INVIERTE4: MOV AX,P2F
	MOV FCORD1,AX
	MOV AX,P1F
	MOV FCORD2,AX
	JMP CUAD1	
INVIERTE5: MOV AX,P2C
	MOV CCORD1,AX
	MOV AX,P1F
	MOV CCORD2,AX
	JMP CUAD1
CUAD1:	MOV AX,FCORD2
	SUB AX,FCORD1
	INC AX
	MOV FIL1,AX
	MOV AX,CCORD2
	SUB AX,CCORD1
	INC AX
	MOV COL1,AX	
	MOV AX,FCORD1
	MOV P1F1,AX
	MOV AX,CCORD1
	MOV P1C1,AX
	MOV AX,COL1
	MOV COL,AX
	MOV AX,FIL1
	MOV FIL,AX
	MOV AH,0CH
	MOV BH,00H
	MOV AL,ATRIBUTO
	MOV DX,P1F1
	MOV CX,P1C1
R1:	INT 10H
	INC CX
	DEC COL
	JNZ R1
	DEC CX
R2:	INT 10H
	INC DX
	DEC FIL
	JNZ R2
	DEC DX
R3:	INT 10H
	DEC CX
	DEC COL1
	JNZ R3
	INC CX
R4:	INT 10H
	DEC DX
	DEC FIL1
	JNZ R4
	CALL TECLA
	JMP INICIO
	
TRIANG:	MOV AX,0000H
	MOV BX,0000H
	MOV CX,0000H
	MOV DX,0000H
	MOV AX,P1F
	MOV BX,P2F
	CMP AX,BX
	JNE VERT1
	MOV AX,P1F
	MOV BX,P2F
	CMP AX,BX
	JA INVIERTE6
	MOV AX,P1F
	MOV FCORD1,AX
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV AX,P2C
	MOV CCORD2,AX
	CALL HORIZONTAL
	JMP TRIAN2
INVIERTE6: MOV AX,P1F
	MOV FCORD1,AX
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD2,AX
	MOV AX,P2C
	MOV CCORD1,AX
	CALL HORIZONTAL
	JMP TRIAN2
VERT1:	MOV AX,P1C
	MOV BX,P2C
	CMP AX,BX
	JNE DIAG1
	MOV AX,P1F
	MOV BX,P2F
	CMP AX,BX	
	JA INVIERTE7
	MOV AX,P1C
	MOV CCORD1,AX
	MOV CCORD2,BX
	MOV AX,P1F
	MOV FCORD1,AX
	MOV AX,P2F
	MOV FCORD2,BX
	CALL VERTICAL
	JMP TRIAN2
INVIERTE7: MOV BX,P2C
	MOV CCORD1,BX
	MOV CCORD2,BX
	MOV AX,P1F
	MOV FCORD2,AX
	MOV AX,P2F
	MOV FCORD1,AX
	CALL VERTICAL
	JMP TRIAN2
DIAG1:	MOV AX,P1F
	MOV BX,P2F
	CMP AX,BX
	JA CASO6
	MOV AX,P1C
	MOV BX,P2C
	CMP AX,BX
	JNB CASO7
CASO5:	MOV AX,P1F
	MOV FCORD1,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV AX,P2F
	MOV FCORD2,AX
	MOV AX,P2C
	MOV CCORD2,AX
	CALL PENDIENTE_N
	JMP TRIAN2
CASO6:	MOV AX,P1C
	MOV BX,P2C
	CMP AX,BX
	JNA CASO8
	MOV AX,P2F
	MOV FCORD1,AX
	MOV AX,P2C
	MOV CCORD1,AX
	MOV AX,P1F
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD2,AX
	CALL PENDIENTE_N
	JMP TRIAN2
CASO7: 	MOV AX,P1F
	MOV FCORD1,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV AX,P2F
	MOV FCORD2,AX
	MOV AX,P2C
	MOV CCORD2,AX
	CALL PENDIENTE_P
	JMP TRIAN2
CASO8: 	MOV AX,P2F
	MOV FCORD1,AX
	MOV AX,P2C
	MOV CCORD1,AX
	MOV AX,P1F
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD2,AX
	CALL PENDIENTE_P
	JMP TRIAN2
TRIAN2:	MOV AX,P2F
	MOV BX,P3F
	CMP AX,BX
	JNE VERT2
	MOV AX,P2F
	MOV BX,P3F
	CMP AX,BX
	JA INVIERTE8
	MOV AX,P2F
	MOV FCORD1,AX
	MOV FCORD2,AX
	MOV AX,P2C
	MOV CCORD1,AX
	MOV AX,P3C
	MOV CCORD2,AX
	CALL HORIZONTAL
	JMP TRIAN3
INVIERTE8: MOV AX,P2F
	MOV FCORD1,AX
	MOV FCORD2,AX
	MOV AX,P2C
	MOV CCORD2,AX
	MOV AX,P3C
	MOV CCORD1,AX
	CALL HORIZONTAL
	JMP TRIAN3
VERT2:	MOV AX,P2C
	MOV BX,P3C
	CMP AX,BX
	JNE DIAG2
	MOV AX,P2F
	MOV BX,P3F
	CMP AX,BX	
	JA INVIERTE9
	MOV AX,P2C
	MOV CCORD1,AX
	MOV CCORD2,BX
	MOV AX,P2F
	MOV FCORD1,AX
	MOV AX,P3F
	MOV FCORD2,BX
	CALL VERTICAL
	JMP TRIAN3
INVIERTE9: MOV BX,P3C
	MOV CCORD1,BX
	MOV CCORD2,BX
	MOV AX,P2F
	MOV FCORD2,AX
	MOV AX,P3F
	MOV FCORD1,AX
	CALL VERTICAL
	JMP TRIAN3
DIAG2:	MOV AX,P2F
	MOV BX,P3F
	CMP AX,BX
	JA CASO10
	MOV AX,P2C
	MOV BX,P3C
	CMP AX,BX
	JNB CASO11
CASO9:	MOV AX,P2F
	MOV FCORD1,AX
	MOV AX,P2C
	MOV CCORD1,AX
	MOV AX,P3F
	MOV FCORD2,AX
	MOV AX,P3C
	MOV CCORD2,AX
	CALL PENDIENTE_N
	JMP TRIAN3
CASO10:	MOV AX,P2C
	MOV BX,P3C
	CMP AX,BX
	JNA CASO12
	MOV AX,P3F
	MOV FCORD1,AX
	MOV AX,P3C
	MOV CCORD1,AX
	MOV AX,P2F
	MOV FCORD2,AX
	MOV AX,P2C
	MOV CCORD2,AX
	CALL PENDIENTE_N
	JMP TRIAN3
CASO11: MOV AX,P2F
	MOV FCORD1,AX
	MOV AX,P2C
	MOV CCORD1,AX
	MOV AX,P3F
	MOV FCORD2,AX
	MOV AX,P3C
	MOV CCORD2,AX
	CALL PENDIENTE_P
	JMP TRIAN3
CASO12:	MOV AX,P3F
	MOV FCORD1,AX
	MOV AX,P3C
	MOV CCORD1,AX
	MOV AX,P2F
	MOV FCORD2,AX
	MOV AX,P2C
	MOV CCORD2,AX
	CALL PENDIENTE_P
	JMP TRIAN3
TRIAN3:	MOV AX,P3F
	MOV BX,P1F
	CMP AX,BX
	JNE VERT3
	MOV AX,P3F
	MOV BX,P1F
	CMP AX,BX
	JA INVIERTE10
	MOV AX,P3F
	MOV FCORD1,AX
	MOV FCORD2,AX
	MOV AX,P3C
	MOV CCORD1,AX
	MOV AX,P1C
	MOV CCORD2,AX
	CALL HORIZONTAL
	CALL TECLA
	JMP INICIO
INVIERTE10: MOV AX,P3F
	MOV FCORD1,AX
	MOV FCORD2,AX
	MOV AX,P3C
	MOV CCORD2,AX
	MOV AX,P1C
	MOV CCORD1,AX
	CALL HORIZONTAL
	CALL TECLA
	JMP INICIO
VERT3:	MOV AX,P3C
	MOV BX,P1C
	CMP AX,BX
	JNE DIAG3
	MOV AX,P3F
	MOV BX,P1F
	CMP AX,BX	
	JA INVIERTE11
	MOV AX,P3C
	MOV CCORD1,AX
	MOV CCORD2,BX
	MOV AX,P3F
	MOV FCORD1,AX
	MOV AX,P1F
	MOV FCORD2,BX
	CALL VERTICAL
	CALL TECLA
	JMP INICIO
INVIERTE11: MOV BX,P1C
	MOV CCORD1,BX
	MOV CCORD2,BX
	MOV AX,P3F
	MOV FCORD2,AX
	MOV AX,P1F
	MOV FCORD1,AX
	CALL VERTICAL
	CALL TECLA
	JMP INICIO 
DIAG3:	MOV AX,P3F
	MOV BX,P1F
	CMP AX,BX
	JA CASO14
	MOV AX,P3C
	MOV BX,P1C
	CMP AX,BX
	JNB CASO15
CASO13:	MOV AX,P3F
	MOV FCORD1,AX
	MOV AX,P3C
	MOV CCORD1,AX
	MOV AX,P1F
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD2,AX
	CALL PENDIENTE_N
	CALL TECLA
	JMP INICIO
CASO14:	MOV AX,P3C
	MOV BX,P1C
	CMP AX,BX
	JNA CASO16
	MOV AX,P1F
	MOV FCORD1,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV AX,P3F
	MOV FCORD2,AX
	MOV AX,P3C
	MOV CCORD2,AX
	CALL PENDIENTE_N
	CALL TECLA
	JMP INICIO
CASO15: MOV AX,P3F
	MOV FCORD1,AX
	MOV AX,P3C
	MOV CCORD1,AX
	MOV AX,P1F
	MOV FCORD2,AX
	MOV AX,P1C
	MOV CCORD2,AX
	CALL PENDIENTE_P
	CALL TECLA
	JMP INICIO
CASO16:	MOV AX,P1F
	MOV FCORD1,AX
	MOV AX,P1C
	MOV CCORD1,AX
	MOV AX,P3F
	MOV FCORD2,AX
	MOV AX,P3C
	MOV CCORD2,AX
	CALL PENDIENTE_P
	CALL TECLA
	JMP INICIO

;AREA DE SUBRUTINAS PARA DIBUJAR FIGURAS HORIZONTAL, VERTICAL Y DIAGONAL

HORIZONTAL:	MOV BP,CCORD2
		SUB BP,CCORD1
		INC BP
		MOV CX,CCORD1
LAZO1:		MOV AH,0CH
		MOV BH,00H
		MOV AL,ATRIBUTO
		MOV DX,FCORD1
		INT 10H
		INC CX
		DEC BP
		JNZ LAZO1
		RET

VERTICAL:       MOV BP,FCORD2	
		SUB BP,FCORD1
		INC BP
		MOV DX,FCORD1
LAZO2:		MOV AH,0CH
		MOV BH,00H
		MOV AL,ATRIBUTO
		MOV CX,CCORD1
		INT 10H
		INC DX
		DEC BP
		JNZ LAZO2
		RET

PENDIENTE_N:	MOV AX,CCORD2
		SUB AX,CCORD1
		MOV BX,FCORD2
		SUB BX,FCORD1
		CMP AX,BX
		JNAE INVIERTE2
		MOV BP,0000H
		MOV DIVISOR,BX
		MOV DX,0000H
		DIV BX
		MOV RESTO,DX
		MOV CUENTA,0000H
		MOV PENDIENTE,AX
		MOV DX,FCORD1
		MOV CX,CCORD1
LAZO30:		MOV DI,PENDIENTE
		ADD DI,BP
		MOV BP,0000H
LAZO31:		MOV AH,0CH
		MOV BH,00H
		MOV AL,ATRIBUTO
		INT 10H
		INC CX
		DEC DI
		JNZ LAZO31
		INC DX
		CMP DX,FCORD2
		JAE SIGU1
		MOV AX,RESTO
		ADD AX,CUENTA
		MOV CUENTA,AX
		CMP AX,DIVISOR
		JNAE SIGUE1
		INC BP
		MOV AX,CUENTA
		SUB AX,DIVISOR
		MOV CUENTA,AX
SIGUE1:		CMP DX,FCORD2
		JNAE LAZO30
SIGU1:		RET
INVIERTE2:   	XCHG AX,BX
		MOV BP,0000H
		MOV DIVISOR,BX
		MOV DX,0000H
		DIV BX
		MOV RESTO,DX
		MOV CUENTA,0000H
		MOV PENDIENTE,AX
		MOV DX,FCORD1
		MOV CX,CCORD1
LAZO32:		MOV DI,PENDIENTE
		ADD DI,BP
		MOV BP,0000H
LAZO33:		MOV AH,0CH
		MOV BH,00H
		MOV AL,ATRIBUTO
		INT 10H
		INC DX
		CMP DX,FCORD2
		JAE SIGU2
		DEC DI
		JNZ LAZO33
		INC CX
		MOV AX,RESTO
		ADD AX,CUENTA
		MOV CUENTA,AX
		CMP AX,DIVISOR
		JNAE SIGUE2
		INC BP
		MOV AX,CUENTA
		SUB AX,DIVISOR
		MOV CUENTA,AX
SIGUE2:		CMP DX,FCORD2
		JNAE LAZO32
SIGU2:		RET

PENDIENTE_P:	MOV AX,CCORD1
		SUB AX,CCORD2
		MOV BX,FCORD2
		SUB BX,FCORD1
		CMP AX,BX
		JNAE INVIERTE3
		MOV BP,0000H
		MOV DIVISOR,BX
		MOV DX,0000H
		DIV BX
		MOV RESTO,DX
		MOV CUENTA,0000H
		MOV PENDIENTE,AX
		MOV DX,FCORD1
		MOV CX,CCORD1
LAZO40:		MOV DI,PENDIENTE
		ADD DI,BP
		MOV BP,0000H
LAZO41:		MOV AH,0CH
		MOV BH,00H
		MOV AL,ATRIBUTO
		INT 10H
		DEC CX
		DEC DI
		JNZ LAZO41
		INC DX
		CMP DX,FCORD2
		JAE SIGU4
		MOV AX,RESTO
		ADD AX,CUENTA
		MOV CUENTA,AX
		CMP AX,DIVISOR
		JNAE SIGUE4
		INC BP
		MOV AX,CUENTA
		SUB AX,DIVISOR
		MOV CUENTA,AX
SIGUE4:		CMP DX,FCORD2
		JNAE LAZO40
SIGU4:		RET
INVIERTE3:   	XCHG AX,BX
		MOV BP,0000H
		MOV DIVISOR,BX
		MOV DX,0000H
		DIV BX
		MOV RESTO,DX
		MOV CUENTA,0000H
		MOV PENDIENTE,AX
		MOV DX,FCORD1
		MOV CX,CCORD1
LAZO42:		MOV DI,PENDIENTE
		ADD DI,BP
		MOV BP,0000H
LAZO43:		MOV AH,0CH
		MOV BH,00H
		MOV AL,ATRIBUTO
		INT 10H
		INC DX
		CMP DX,FCORD2
		JAE FIN2
		DEC DI
		JNZ LAZO43
		INC CX
		MOV AX,RESTO
		ADD AX,CUENTA
		MOV CUENTA,AX
		CMP AX,DIVISOR
		JNAE SIGUE3
		INC BP
		MOV AX,CUENTA
		SUB AX,DIVISOR
		MOV CUENTA,AX
SIGUE3:		CMP DX,FCORD2
		JNAE LAZO42
FIN2:  		RET

;AREA DE RUTINAS DE INTERRUPCION MODO TEXTO

MODO:	MOV AH,00H
	INT 10H
	RETN

CURSOR:	MOV AH,02H
	INT 10H
	RETN

BLAN:	MOV AH,09H
	MOV CX,2000
	MOV AL,20H
	MOV BL,07H
	INT 10H
	RETN

PAG:	MOV AH,05H
	INT 10H
	RETN

IMPRIME: MOV AH,09H
	INT 21H
	RETN

TECLA:	MOV AH,00H
	INT 16H
	RETN

CONV:	MOV CANT,03H
	MOV DI,OFFSET BUFFER1
C1:	MOV AL,DS:[SI]
	MOV DS:[DI],AL
	INC SI
	INC DI
	DEC CANT
	JNZ C1
	MOV DI,OFFSET BUFFER1
	MOV AH,DS:[DI]
	INC DI
	MOV AL,DS:[DI]
	ROL AL,4
	INC DI
	OR AL,DS:[DI]
	RETN

ABRIR:	MOV AH,3DH
	MOV AL,02H
	INT 21H
	RETN

	END
