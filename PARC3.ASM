;	Israel Celis Campagnoli
;	twitter @israelcelis1310
;	https://ve.linkedin.com/in/israelceliscampagnoli
;	Practicas en Assembler Digitales III
;	Universidad Nacional Experimental "Antonio Jóse de Sucre"
;	Vicerectorado "Luis Caballero Mejías"	

		.MODEL SMALL
		.STACK 100H
		.DATA
BUFF		DW 2000H DUP(?)		
CESI		DW 0000H
CEID		DW 0000H
CESI1		DW 0000H
FILA		DB 01H
COLUMNA		DB 3BH
UT1		DW 00H
UT2		DW 00H
ATRI		DB 07H
CESIREC		DW 0000H
FILAREC		DB 00H
COLUMREC	DB 00H
CONT1		DB 00H
CONT2		DB 40H
LETRA		DB 00H
		.CODE
		MOV AX,SEG BUFF
		MOV DS,AX
		MOV AX,0B800H
		MOV ES,AX
		CALL BLK
		MOV CESI,0B14H
		MOV CEID,0E3BH
L2:  		MOV DX,CESI
		CALL CALCULA
		CALL GUARDA
		CALL ESCRIBE
		JMP	L2
SALIR:		MOV AH,00H
		INT 16H
		MOV AX,4C00H
		INT 21H
CALCULA:	MOV AX,0000H
       		MOV CX,0000H
		MOV BL,0A0H
		MOV AL,DH
		MUL BL
		MOV CL,DL
		ADD CX,CX
		ADD AX,CX
		MOV CESI1,AX
		RETN
  		
      BLK:	MOV SI,0000H
		MOV AX,0720H
		MOV CX,4000H
      B1:	MOV ES:[SI],AX
      		ADD SI,0002H
		LOOP B1
		RETN

      GUARDA:	MOV SI,CESI1
      		MOV CESIREC,SI
		MOV UT1,SI
		MOV CH,FILA
		MOV FILAREC,CH
		MOV CL,COLUMNA
		MOV COLUMREC,CL
		MOV DI,OFFSET BUFF
      SIGFILA:  MOV SI,UT1
      		MOV CL,COLUMNA
      PROX:	MOV AX,ES:[SI]
      		MOV DS:[DI],AX
		ADD SI,0002H
		ADD DI,0002H
		DEC CL
		JNZ PROX
		ADD UT1,0A0H
		DEC CH
		JNZ SIGFILA
		RETN
       CURSOR:  MOV AH,02H
       		MOV BH,00H
		MOV DX,1010H
       		INT 21H
		RETN
	
ESCRIBE:	MOV AX,CESI1
		MOV UT2,AX
		MOV DI,UT2
SA1:		DEC CONT2
		JZ LINSIG
		MOV AH,00H
       		INT 16H
		CMP	AL,0DH
		JE LINSIG
		MOV LETRA,AL
		MOV AH,ATRI
		MOV AL,LETRA
		MOV ES:[DI],AX
		ADD DI,0002
		JMP SA1
LINSIG:		INC CONT1
		MOV CONT2,40H
		CMP CONT1,04H
		JE SALIR1
		MOV AX,CESI
       		INC AH
		MOV CESI,AX
		RETN
SALIR1:		JMP	SALIR
		END